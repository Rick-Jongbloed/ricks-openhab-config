// should be removed once test is over and it's working in jython

rule "test_deurbel_xtend" 		//moet kodi nog toevoegen?
when
	Item test_switch_deurbel changed
then
    logInfo("rule-test","PUSHOVERTEST - Startup")
    val msg = "XTEND RULE TEST"
    val camURL = "http://192.168.1.25:88/cgi-bin/CGIProxy.fcgi?cmd=snapPicture2&usr=rick&pwd=eY8aQArrk9QU"
    val file = now.toString.replaceAll("[:\\/ \\+]+", "_") +".jpg"
    val outputFile = "" + file
    var String curl_result = executeCommandLine("curl -m 10 -o " + outputFile + " " + camURL, 5000)
    sendPushoverMessage(pushoverBuilder(msg))
    sendPushoverMessage(pushoverBuilder(msg).withAttachment(outputFile))
    logInfo("rule-test","PUSHOVERTEST - MIDDLE")
    // delete the temp file after 60 seconds
    createTimer(now.plusSeconds(60)) [|
        executeCommandLine("rm " + outputFile)
    ]
    logInfo("rule-test","PUSHOVERTEST - END:: ONtimer set to start sRefresh to ON in 20 seconds")
end